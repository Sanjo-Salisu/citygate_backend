{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EmpireTrust | Gallery CRUD</title>

<style>
body { font-family: "Poppins", sans-serif; background: #f5f5f5; padding:2rem; }
nav { background: #ff7a00; color: white; padding: 1.0rem 1.5rem; display: flex; justify-content: space-between; align-items: center; }
nav a { color: white; text-decoration: none; margin-left: 1rem; font-weight: bold; }
.next{ padding-top: 7rem; }
h1 { color:#ff7a00; text-align:center; margin-bottom:1.5rem; }
h2 { color:#333; margin-top:2rem; }
table { width:100%; border-collapse: collapse; background:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.1); border-radius:10px; overflow:hidden; margin-bottom:2rem; }
th, td { padding:0.8rem 1rem; text-align:left; border-bottom:1px solid #ddd; }
th { background:#ff7a00; color:#fff; }
tr:hover { background:#ffe5cc; }
img { width:80px; height:60px; object-fit:cover; border-radius:5px; }
.btn-delete { background:#ff4d4d; color:white; padding:0.4rem 0.8rem; border:none; border-radius:5px; cursor:pointer; }
.btn-delete:hover { background:#cc0000; }
.btn-add { background:#ff7a00; color:white; padding:0.6rem 1rem; border-radius:5px; text-decoration:none; font-weight:bold; }
.btn-add:hover { background:#e67300; }
form.upload-form { margin-bottom:1.5rem; display:flex; gap:1rem; align-items:center; }
form.upload-form input[type="text"], 
form.upload-form select { padding:0.5rem; flex:1; border-radius:5px; border:1px solid #ddd; }
form.upload-form input[type="file"] { border:none; }
</style>
</head>
<body>

<nav>
    <div>EmpireTrust Management</div>
    <div>
        <a href="/accounts/login/">Logout</a>
        <a href="/gallery_crud/">Home</a>
    </div>
</nav>

<div class="next">

<h1>Gallery Management</h1>

<!-- UPLOAD FORM -->
<form method="POST" enctype="multipart/form-data" class="upload-form">
    {% csrf_token %}
    <input type="text" name="title" placeholder="Image Title" required>
    <input type="file" name="image" accept="image/*" required>

    <!-- Section Dropdown -->
    <select name="section" required>
        <option value="" disabled selected>Select Section</option>
        <option value="first">First Section</option>
        <option value="second">Second Section</option>
        <option value="third">Third Section</option>
    </select>

    <button type="submit" class="btn-add">Upload</button>
</form>

<!-- FIRST SECTION -->
<h2>First Section</h2>
<table>
<thead>
<tr>
  <th>#</th>
  <th>Image</th>
  <th>Title</th>
  <th>Action</th>
</tr>
</thead>
<tbody>
{% for img in first_section_images %}
<tr>
  <td>{{ forloop.counter }}</td>
  <td>{% if img.image %}<img src="{{ img.image.url }}" alt="{{ img.title }}">{% else %}No Image{% endif %}</td>
  <td>{{ img.title }}</td>
  <td>
    <form method="POST" action="{% url 'delete_image' img.id %}">
      {% csrf_token %}
      <button class="btn-delete">Delete</button>
    </form>
  </td>
</tr>
{% empty %}
<tr><td colspan="6" style="text-align:center;">No images in this section.</td></tr>
{% endfor %}
</tbody>
</table>

<!-- SECOND SECTION -->
<h2>Second Section</h2>
<table>
<thead>
<tr>
  <th>#</th>
  <th>Image</th>
  <th>Title</th>
  <th>Action</th>
</tr>
</thead>
<tbody>
{% for img in second_section_images %}
<tr>
  <td>{{ forloop.counter }}</td>
  <td>{% if img.image %}<img src="{{ img.image.url }}" alt="{{ img.title }}">{% else %}No Image{% endif %}</td>
  <td>{{ img.title }}</td>
  <td>
    <form method="POST" action="{% url 'delete_image' img.id %}">
      {% csrf_token %}
      <button class="btn-delete">Delete</button>
    </form>
  </td>
</tr>
{% empty %}
<tr><td colspan="6" style="text-align:center;">No images in this section.</td></tr>
{% endfor %}
</tbody>
</table>

<!-- THIRD SECTION -->
<h2>Third Section</h2>
<table>
<thead>
<tr>
  <th>#</th>
  <th>Image</th>
  <th>Title</th>
  <th>Action</th>
</tr>
</thead>
<tbody>
{% for img in third_section_images %}
<tr>
  <td>{{ forloop.counter }}</td>
  <td>{% if img.image %}<img src="{{ img.image.url }}" alt="{{ img.title }}">{% else %}No Image{% endif %}</td>
  <td>{{ img.title }}</td>
  <td>{% if img.uploaded_by %}{{ img.uploaded_by.username }}{% else %}Anonymous{% endif %}</td>

  <td>
    <form method="POST" action="{% url 'delete_image' img.id %}">
      {% csrf_token %}
      <button class="btn-delete">Delete</button>
    </form>
  </td>
</tr>
{% empty %}
<tr><td colspan="6" style="text-align:center;">No images in this section.</td></tr>
{% endfor %}
</tbody>
</table>

</div>
</body>
</html>
